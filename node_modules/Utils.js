class Utils {
    constructor() {
        this.competitionsByCountry = [
            {
                country_id: "en",
                name:"Angleterre",
                id: "england", 
                competitions : {
                    "PL": {
                        id:445
                    },
                    "ELC": {
                        id:446
                    },
                    "EL1": {
                        id:447
                    },
                    "EL2": {
                        id:448
                    }
                }
                
            },
            {
                country_id: "nl",
                name: "Pays-Bas",
                id: "netherlands",
                competitions: {
                    "DED": {
                        id:449
                    }
                    
                }
                
            },
            {
                country_id:"fr",
                name: "France", 
                id:"france",
                competitions: {
                    "FL1": {
                        id: 450
                    },
                    "FL2": {
                        id:451
                    }
                }
                 
                
                
            },
            {
                country_id: "de",
                name: "Allemagne",
                id:"germany",
                competitions: {
                    "BL1" : {
                        id: 452
                    
                    },
                    "BL2": {
                        id: 453
                    },
                    "DFB": {
                        id: 458
                    }
                }
                
            },
            {
                country_id: "es",
                name:"Espagne",
                id:"spain",
                competitions: {
                    
                    "PPL": {
                        id:457
                    }
                }
                    
                
                
            },
            {
                country_id: "pt",
                name:"Portugal",
                id:"portugal",
                competitions: {
                    "PD": {
                        id:455
                    }
                }
            },
            {
                country_id: "it",
                name: "Italie",
                id:"italy",
                competitions: {
                    "SA": {
                        id:456
                    },
                    "SB": {
                        id:459
                    }
                }
                
            },
            {
                country_id: "eu",
                name: "Europe",
                id:"europe",
                competitions: {
                    "CL": {
                        id: 464        
                    }
                }
                    
                
                
            },
            {
                country_id: "au",
                name: "Australie",
                id:"australia", 
                competitions : {
                    "AAL": {
                        id:466
                    }
                }
                
            },
            {
                country_id: "br",
                name:"BrÃ©sil",
                id: "brazil", 
                competitions : {
                    "BSA": {
                        id: 444
                    }
                }
                
            }


        ]
        
    }
    
    getCompetitionsByCountry(country_id) {
        
        for(let elem of this.competitionsByCountry) {
            if(elem.country_id === country_id) {
                return Object.keys(elem.competitions);
            }
        }
        
        return -1;
    }
    
    generateRequest(params) {
        let url = "http://api.football-data.org/v1";
        
        switch(params.request_type) {
            case "competitions": 
                url += "/competitions";
                (typeof params.season !== "undefined") ? url += `?season=${params.season}` : ""; 
            break;
            case "results":
                url += `/competitions/${params.competition_id}/fixtures`;
                (typeof params.matchday !== "undefined") ? url += `?matchday=${params.matchday}` : ""; 
            break;
            case "ranking":
                url += `/competitions/${params.competition_id}/leagueTable`;
                (typeof params.matchday !== "undefined") ? url += `?matchday=${params.matchday}` : ""; 
            break;
            case "teams_in_championship":
                url += `/competitions/${params.competition_id}/teams`;
            break;
            case "team_roster": 
                url += `/teams/${params.team_id}/players`;
            break;
            case "team_info": 
                url += `/teams/${params.team_id}`;
            break;     
            case "competition_info": 
                url += `/competitions/${params.competition_id}/`
            break;
        }
        
        return url;
    }
    
    getCountryList() {
        
        return [{
                "id": "en",
                "name": "Angleterre",
                "country_text": "england"
            },
            {
                "id": "nl",
                "name": "Pays-Bas",
                "country_text": "netherlands"
            },
            {
                "id": "fr",
                "name": "France",
                "country_text": "france"
            },
            {
                "id": "de",
                "name": "Allemagne",
                "country_text": "germany"

            },
            {
                "id": "es",
                "name": "Espagne",
                "country_text": "spain"
            },
            {
                "id": "it",
                "name": "Italie",
                "country_text": "italy"
            },
            {
                "id": "eu",
                "name": "Europe",
                "country_text": "europe"
            },
            {
                "id": "au",
                "name": "Australie",
                "country_text": "australia"
            },
            {
                "id": "pt",
                "name": "Portugal",
                "country_text":"portugal"
            }
            
               ];
    }
    

    
    getCompetitionsById(id) {
        let result = [];
        for(let country of this.competitionsByCountry) {

            /* TODO : simplify it and add new functions */
            if(country.country_id === id) {
                Object.keys(country.competitions).forEach((key) => { // We get the ID of 
                    result.push(country.competitions[key].id);
                });
                

                return result;
            }
        }
    }
    
    getQualificationPlaces(id) {
        switch(id) {
            case "445": // Premier League
                return {
                    "c1": [2,3,4],
                    "c3": [5],
                    "promotion": [],
                    "playoffsup": [],
                    "playoffsdown": [],
                    "relegation": [18,19,20]
                    
                }
            break;
            case "446": // Championship
                return {
                    "c1": [],
                    "c3": [],
                    "promotion": [2],
                    "playoffsup": [3,4,5,6],
                    "playoffsdown": [],
                    "relegation": [22,23,24]
                }
            break;
            case "448": // League Two
                return {
                    "c1": [],
                    "c3": [],
                    "promotion": [2,3],
                    "playoffsup": [4,5,6,7],
                    "playoffsdown": [],
                    "relegation": [23,24]
                }
            break;
            case "449": // Eredivisie
                return {
                    "c1": [2],
                    "c3": [3,4],
                    "promotion": [],
                    "playoffsup": [5,6,7,8],
                    "playoffsdown": [16,17],
                    "relegation": [18]
                }
            break;
            case "450": // Ligue 1
                return {
                    "c1": [2, 3],
                    "c3": [4],
                    "promotion": [],
                    "playoffsup": [],
                    "playoffsdown": [18],
                    "relegation": [19, 20]
                }
            break;
            case "451": // Ligue 2
                return {
                    "c1": [],
                    "c3": [],
                    "promotion": [2],
                    "playoffsup": [3,4,5],
                    "playoffsdown": [18],
                    "relegation": [19,20]
                }
            break;
            case "452": // 1. Bundesliga
                return {
                    "c1": [2,3,4],
                    "c3": [5,6],
                    "promotion": [],
                    "playoffsup": [],
                    "playoffsdown": [16],
                    "relegation": [17,18]
                }
            break;
            case "453": // 2. Bundesliga
                return {
                    "c1": [],
                    "c3": [],
                    "promotion": [2],
                    "playoffsup": [3],
                    "playoffsdown": [16],
                    "relegation": [17,18]
                }
            case "456": // Serie A
                return {
                    "c1": [2,3],
                    "c3": [4,5],
                    "promotion": [],
                    "playoffsup": [],
                    "playoffsdown": [],
                    "relegation": [18,19,20]
                    
                }
            break;
            default:
                return {
                    "c1": [],
                    "c3": [],
                    "promotion": [2],
                    "playoffsup": [3,4,5,6],
                    "playoffsdown": [],
                    "relegation": [22,23,24]
                }
            break;
        }
    }
    
    getCountryClass(competition_id) { // Inserts an attribute "id" in the response for each competition so that the frontend is colored according to the country of origin
        for(let elem of this.competitionsByCountry) {

            if(Object.keys(elem.competitions).indexOf(competition_id) >= 0) {
                return elem.id;
            }

            
        }
    }
}


module.exports = Utils;